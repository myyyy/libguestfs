
<html>
<head>
<title>virt-format</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link rel='stylesheet' href='pod.css' type='text/css' />
</head>
<body>


<ul id="index">
  <li><a href="#name">NAME</a></li>
  <li><a href="#synopsis">SYNOPSIS</a></li>
  <li><a href="#description">DESCRIPTION</a></li>
  <li><a href="#options">OPTIONS</a></li>
  <li><a href="#exit-status">EXIT STATUS</a></li>
  <li><a href="#see-also">SEE ALSO</a></li>
  <li><a href="#author">AUTHOR</a></li>
  <li><a href="#copyright">COPYRIGHT</a></li>
  <li><a href="#license">LICENSE</a></li>
  <li><a href="#bugs">BUGS</a></li>
</ul>

<h1 id="name">NAME</h1>

<p>virt-format - Erase and make a blank disk</p>

<h1 id="synopsis">SYNOPSIS</h1>

<pre><code> virt-format [--options] -a disk.img [-a disk.img ...]</code></pre>

<h1 id="description">DESCRIPTION</h1>

<p>Virt-format takes an existing disk file (or it can be a host partition, LV etc), <b>erases all data on it</b>, and formats it as a blank disk. It can optionally create partition tables, empty filesystems, logical volumes and more.</p>

<p>To create a disk containing data, you may be better to use <a href="virt-make-fs.1.html">virt-make-fs(1)</a>. If you are creating a blank disk to use in <a href="guestfish.1.html">guestfish(1)</a>, you should instead use the guestfish <i>-N</i> option.</p>

<p>Normal usage would be something like this:</p>

<pre><code> virt-format -a disk.qcow</code></pre>

<p>or this:</p>

<pre><code> virt-format -a /dev/VG/LV</code></pre>

<p><i>disk.qcow</i> or <i>/dev/VG/LV</i> must exist already. <b>Any data on these disks will be erased by these commands</b>. These commands will create a single empty partition covering the whole disk, with no filesystem inside it.</p>

<p>Additional parameters can be used to control the creation of partitions, filesystems, etc. The most commonly used options are:</p>

<dl>

<dt><i>--filesystem=[ext3|ntfs|vfat|...]</i></dt>
<dd>

<p>Create an empty filesystem (<code>ext3</code>, <code>ntfs</code> etc) inside the partition.</p>

</dd>
<dt><i>--lvm[=/dev/VG/LV]</i></dt>
<dd>

<p>Create a Linux LVM2 logical volume on the disk. When used with <i>--filesystem</i>, the filesystem is created inside the LV.</p>

</dd>
</dl>

<p>For more information about these and other options, see <a href="#options">&quot;OPTIONS&quot;</a> below.</p>

<p>The format of the disk is normally auto-detected, but you can also force it by using the <i>--format</i> option (q.v.). In situations where you do not trust the existing content of the disk, then it is advisable to use this option to avoid possible exploits.</p>

<h1 id="options">OPTIONS</h1>

<dl>

<dt><b>--help</b></dt>
<dd>

<p>Display brief help.</p>

</dd>
<dt><b>-a</b> file</dt>
<dd>

</dd>
<dt><b>--add</b> file</dt>
<dd>

<p>Add <i>file</i>, a disk image, host partition, LV, external USB disk, etc.</p>

<p>The format of the disk image is auto-detected. To override this and force a particular format use the <i>--format=..</i> option.</p>

<p><b>Any existing data on the disk is erased.</b></p>

</dd>
<dt><b>-a URI</b></dt>
<dd>

</dd>
<dt><b>--add URI</b></dt>
<dd>

<p>Add a remote disk. See <a href="guestfish.1.html#adding-remote-storage">&quot;ADDING REMOTE STORAGE&quot; in guestfish(1)</a>.</p>

</dd>
<dt><b>--filesystem=ext3|ntfs|vfat|...</b></dt>
<dd>

<p>Create an empty filesystem of the specified type. Many filesystem types are supported by libguestfs.</p>

</dd>
<dt><b>--filesystem=none</b></dt>
<dd>

<p>Create no filesystem. This is the default.</p>

</dd>
<dt><b>--format=raw|qcow2|..</b></dt>
<dd>

</dd>
<dt><b>--format</b></dt>
<dd>

<p>The default for the <i>-a</i> option is to auto-detect the format of the disk image. Using this forces the disk format for <i>-a</i> options which follow on the command line. Using <i>--format</i> with no argument switches back to auto-detection for subsequent <i>-a</i> options.</p>

<p>For example:</p>

<pre><code> virt-format --format=raw -a disk.img</code></pre>

<p>forces raw format (no auto-detection) for <i>disk.img</i>.</p>

<pre><code> virt-format --format=raw -a disk.img --format -a another.img</code></pre>

<p>forces raw format (no auto-detection) for <i>disk.img</i> and reverts to auto-detection for <i>another.img</i>.</p>

<p>If you have untrusted raw-format guest disk images, you should use this option to specify the disk format. This avoids a possible security problem with malicious guests (CVE-2010-3851).</p>

</dd>
<dt><b>--label=LABEL</b></dt>
<dd>

<p>Set the filesystem label.</p>

</dd>
<dt><b>--lvm=/dev/<i>VG</i>/<i>LV</i></b></dt>
<dd>

<p>Create a Linux LVM2 logical volume called <i>/dev/<i>VG</i>/<i>LV</i></i>. You can change the name of the volume group and logical volume.</p>

</dd>
<dt><b>--lvm</b></dt>
<dd>

<p>Create a Linux LVM2 logical volume with the default name (<i>/dev/VG/LV</i>).</p>

</dd>
<dt><b>--lvm=none</b></dt>
<dd>

<p>Create no logical volume. This is the default.</p>

</dd>
<dt><b>--partition</b></dt>
<dd>

<p>Create either an MBR or GPT partition covering the whole disk. MBR is chosen if the disk size is &lt; 2 TB, GPT if &ge; 2 TB.</p>

<p>This is the default.</p>

</dd>
<dt><b>--partition=gpt</b></dt>
<dd>

<p>Create a GPT partition.</p>

</dd>
<dt><b>--partition=mbr</b></dt>
<dd>

<p>Create an MBR partition.</p>

</dd>
<dt><b>--partition=none</b></dt>
<dd>

<p>Create no partition table. Note that Windows may not be able to see these disks.</p>

</dd>
<dt><b>-v</b></dt>
<dd>

</dd>
<dt><b>--verbose</b></dt>
<dd>

<p>Enable verbose messages for debugging.</p>

</dd>
<dt><b>-V</b></dt>
<dd>

</dd>
<dt><b>--version</b></dt>
<dd>

<p>Display version number and exit.</p>

</dd>
<dt><b>--wipe</b></dt>
<dd>

<p>Normally virt-format does not wipe data from the disk (because that takes a long time). Thus if there is data on the disk, it is only hidden and partially overwritten by virt-format, and it might be recovered by disk editing tools.</p>

<p>If you use this option, virt-format writes zeroes over the whole disk so that previous data is not recoverable.</p>

</dd>
<dt><b>-x</b></dt>
<dd>

<p>Enable tracing of libguestfs API calls.</p>

</dd>
</dl>

<h1 id="exit-status">EXIT STATUS</h1>

<p>This program returns <code>0</code> on success, or <code>1</code> on failure.</p>

<h1 id="see-also">SEE ALSO</h1>

<p><a href="guestfs.3.html">guestfs(3)</a>, <a href="guestfish.1.html">guestfish(1)</a>, <a href="virt-filesystems.1.html">virt-filesystems(1)</a>, <a href="virt-make-fs.1.html">virt-make-fs(1)</a>, <a href="virt-rescue.1.html">virt-rescue(1)</a>, <a href="virt-resize.1.html">virt-resize(1)</a>, <a href="http://libguestfs.org/">http://libguestfs.org/</a>.</p>

<h1 id="author">AUTHOR</h1>

<p>Richard W.M. Jones <a href="http://people.redhat.com/~rjones/">http://people.redhat.com/~rjones/</a></p>

<h1 id="copyright">COPYRIGHT</h1>

<p>Copyright (C) 2012 Red Hat Inc.</p>

<h1 id="license">LICENSE</h1>

<p>This program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.</p>

<p>This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</p>

<p>You should have received a copy of the GNU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.</p>

<h1 id="bugs">BUGS</h1>

<p>To get a list of bugs against libguestfs, use this link: <a href="https://bugzilla.redhat.com/buglist.cgi?component=libguestfs&amp;product=Virtualization+Tools">https://bugzilla.redhat.com/buglist.cgi?component=libguestfs&amp;product=Virtualization+Tools</a></p>

<p>To report a new bug against libguestfs, use this link: <a href="https://bugzilla.redhat.com/enter_bug.cgi?component=libguestfs&amp;product=Virtualization+Tools">https://bugzilla.redhat.com/enter_bug.cgi?component=libguestfs&amp;product=Virtualization+Tools</a></p>

<p>When reporting a bug, please supply:</p>

<ul>

<li><p>The version of libguestfs.</p>

</li>
<li><p>Where you got libguestfs (eg. which Linux distro, compiled from source, etc)</p>

</li>
<li><p>Describe the bug accurately and give a way to reproduce it.</p>

</li>
<li><p>Run <a href="libguestfs-test-tool.1.html">libguestfs-test-tool(1)</a> and paste the <b>complete, unedited</b> output into the bug report.</p>

</li>
</ul>

</body>
</html>


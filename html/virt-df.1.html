
<html>
<head>
<title>virt-df</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link rel='stylesheet' href='pod.css' type='text/css' />
</head>
<body>


<ul id="index">
  <li><a href="#name">NAME</a></li>
  <li><a href="#synopsis">SYNOPSIS</a></li>
  <li><a href="#description">DESCRIPTION</a></li>
  <li><a href="#examples">EXAMPLES</a></li>
  <li><a href="#options">OPTIONS</a></li>
  <li><a href="#statvfs-numbers">STATVFS NUMBERS</a></li>
  <li><a href="#note-about-csv-format">NOTE ABOUT CSV FORMAT</a></li>
  <li><a href="#exit-status">EXIT STATUS</a></li>
  <li><a href="#see-also">SEE ALSO</a></li>
  <li><a href="#author">AUTHOR</a></li>
  <li><a href="#copyright">COPYRIGHT</a></li>
  <li><a href="#license">LICENSE</a></li>
  <li><a href="#bugs">BUGS</a></li>
</ul>

<h1 id="name">NAME</h1>

<p>virt-df - Display free space on virtual filesystems</p>

<h1 id="synopsis">SYNOPSIS</h1>

<p>All guests:</p>

<pre><code> virt-df [--options]</code></pre>

<p>Single guest:</p>

<pre><code> virt-df [--options] -d domname

 virt-df [--options] -a disk.img [-a disk.img ...]</code></pre>

<p>Old style:</p>

<pre><code> virt-df [--options] domname

 virt-df [--options] disk.img [disk.img ...]</code></pre>

<h1 id="description">DESCRIPTION</h1>

<p><code>virt-df</code> is a command line tool to display free space on virtual machine filesystems. Unlike other tools, it doesn&#39;t just display the size of disk allocated to a virtual machine, but can look inside disk images to see how much space is really being used.</p>

<p>If used without any <i>-a</i> or <i>-d</i> arguments, <code>virt-df</code> checks with libvirt to get a list of all active and inactive guests, and performs a <code>df</code>-type operation on each one in turn, printing out the results.</p>

<p>If any <i>-a</i> or <i>-d</i> arguments are specified, <code>virt-df</code> performs a <code>df</code>-type operation on either the single named libvirt domain, or on the disk image(s) listed on the command line (which must all belong to a single VM). <b>In this mode (with arguments), <code>virt-df</code> will only work for a single guest</b>. If you want to run on multiple guests, then you have to invoke <code>virt-df</code> multiple times.</p>

<p>Use the <i>--csv</i> option to get a format which can be easily parsed by other programs. Other options are similar to the standard <a href="http://man.he.net/man1/df">df(1)</a> command.</p>

<h1 id="examples">EXAMPLES</h1>

<p>Show disk usage for a single libvirt guest called <code>F14x64</code>. Make the output human-readable:</p>

<pre><code> # virt-df -d F14x64 -h
 Filesystem                       Size     Used  Available  Use%
 F14x64:/dev/sda1                 484M      66M       393M   14%
 F14x64:/dev/vg_f13x64/lv_root    7.4G     3.4G       4.0G   46%</code></pre>

<p>Show disk usage for a disk image file called <i>test.img</i>:</p>

<pre><code> $ virt-df -a test1.img
 Filesystem                  1K-blocks     Used  Available  Use%
 test1.img:/dev/sda1             99099     1551      92432    2%</code></pre>

<p>If a single guest has multiple disks, use the <i>-a</i> option repeatedly. A plus sign (<code>+</code>) is displayed for each additional disk. <b>Note: Do not do this with unrelated guest disks.</b></p>

<pre><code> $ virt-df -a Win7x32TwoDisks-a -a Win7x32TwoDisks-b 
 Filesystem                   1K-blocks    Used  Available  Use%
 Win7x32TwoDisks-a+:/dev/sda1    102396   24712      77684   25%
 Win7x32TwoDisks-a+:/dev/sda2  12478460 7403416    5075044   60%
 Win7x32TwoDisks-a+:/dev/sdb1    521212   55728     465484   11%</code></pre>

<h1 id="options">OPTIONS</h1>

<dl>

<dt><b>--help</b></dt>
<dd>

<p>Display brief help.</p>

</dd>
<dt><b>-a</b> file</dt>
<dd>

</dd>
<dt><b>--add</b> file</dt>
<dd>

<p>Add <i>file</i> which should be a disk image from a virtual machine. If the virtual machine has multiple block devices, you must supply all of them with separate <i>-a</i> options.</p>

<p>The format of the disk image is auto-detected. To override this and force a particular format use the <i>--format=..</i> option.</p>

</dd>
<dt><b>-a URI</b></dt>
<dd>

</dd>
<dt><b>--add URI</b></dt>
<dd>

<p>Add a remote disk. See <a href="guestfish.1.html#adding-remote-storage">&quot;ADDING REMOTE STORAGE&quot; in guestfish(1)</a>.</p>

</dd>
<dt><b>-c</b> URI</dt>
<dd>

</dd>
<dt><b>--connect</b> URI</dt>
<dd>

<p>If using libvirt, connect to the given <i>URI</i>. If omitted, then we connect to the default libvirt hypervisor.</p>

<p>If you specify guest block devices directly (<i>-a</i>), then libvirt is not used at all.</p>

</dd>
<dt><b>--csv</b></dt>
<dd>

<p>Write out the results in CSV format (comma-separated values). This format can be imported easily into databases and spreadsheets, but read <a href="#note-about-csv-format">&quot;NOTE ABOUT CSV FORMAT&quot;</a> below.</p>

</dd>
<dt><b>-d</b> guest</dt>
<dd>

</dd>
<dt><b>--domain</b> guest</dt>
<dd>

<p>Add all the disks from the named libvirt guest. Domain UUIDs can be used instead of names.</p>

</dd>
<dt><b>--format=raw|qcow2|..</b></dt>
<dd>

</dd>
<dt><b>--format</b></dt>
<dd>

<p>The default for the <i>-a</i> option is to auto-detect the format of the disk image. Using this forces the disk format for <i>-a</i> options which follow on the command line. Using <i>--format</i> with no argument switches back to auto-detection for subsequent <i>-a</i> options.</p>

<p>For example:</p>

<pre><code> virt-df --format=raw -a disk.img</code></pre>

<p>forces raw format (no auto-detection) for <i>disk.img</i>.</p>

<pre><code> virt-df --format=raw -a disk.img --format -a another.img</code></pre>

<p>forces raw format (no auto-detection) for <i>disk.img</i> and reverts to auto-detection for <i>another.img</i>.</p>

<p>If you have untrusted raw-format guest disk images, you should use this option to specify the disk format. This avoids a possible security problem with malicious guests (CVE-2010-3851).</p>

</dd>
<dt><b>-h</b></dt>
<dd>

</dd>
<dt><b>--human-readable</b></dt>
<dd>

<p>Print sizes in human-readable format.</p>

<p>You are not allowed to use <i>-h</i> and <i>--csv</i> at the same time.</p>

</dd>
<dt><b>-i</b></dt>
<dd>

</dd>
<dt><b>--inodes</b></dt>
<dd>

<p>Print inodes instead of blocks.</p>

</dd>
<dt><b>--one-per-guest</b></dt>
<dd>

<p>Since libguestfs 1.22, this is the default. This option does nothing and is left here for backwards compatibility with older scripts.</p>

</dd>
<dt><b>-P</b> nr_threads</dt>
<dd>

<p>Since libguestfs 1.22, virt-df is multithreaded and examines guests in parallel. By default the number of threads to use is chosen based on the amount of free memory available at the time that virt-df is started. You can force virt-df to use at most <code>nr_threads</code> by using the <i>-P</i> option.</p>

<p>Note that <i>-P 0</i> means to autodetect, and <i>-P 1</i> means to use a single thread.</p>

</dd>
<dt><b>--uuid</b></dt>
<dd>

<p>Print UUIDs instead of names. This is useful for following a guest even when the guest is migrated or renamed, or when two guests happen to have the same name.</p>

<p>Note that only domains that we fetch from libvirt come with UUIDs. For disk images, we still print the disk image name even when this option is specified.</p>

</dd>
<dt><b>-v</b></dt>
<dd>

</dd>
<dt><b>--verbose</b></dt>
<dd>

<p>Enable verbose messages for debugging.</p>

</dd>
<dt><b>-V</b></dt>
<dd>

</dd>
<dt><b>--version</b></dt>
<dd>

<p>Display version number and exit.</p>

</dd>
<dt><b>-x</b></dt>
<dd>

<p>Enable tracing of libguestfs API calls.</p>

</dd>
</dl>

<h1 id="statvfs-numbers">STATVFS NUMBERS</h1>

<p><code>virt-df</code> (and <a href="http://man.he.net/man1/df">df(1)</a>) get information by issuing a <a href="http://man.he.net/man3/statvfs">statvfs(3)</a> system call. You can get the same information directly, either from the host (using libguestfs) or inside the guest:</p>

<dl>

<dt>From the host</dt>
<dd>

<p>Run this command:</p>

<pre><code> guestfish --ro -d GuestName -i statvfs /</code></pre>

<p>(change <i>/</i> to see stats for other filesystems).</p>

</dd>
<dt>From inside the guest</dt>
<dd>

<p>Run this command:</p>

<pre><code> python -c &#39;import os; s = os.statvfs (&quot;/&quot;); print s&#39;</code></pre>

<p>(change <i>/</i> to see stats for other filesystems).</p>

</dd>
</dl>

<h1 id="note-about-csv-format">NOTE ABOUT CSV FORMAT</h1>

<p>Comma-separated values (CSV) is a deceptive format. It <i>seems</i> like it should be easy to parse, but it is definitely not easy to parse.</p>

<p>Myth: Just split fields at commas. Reality: This does <i>not</i> work reliably. This example has two columns:</p>

<pre><code> &quot;foo,bar&quot;,baz</code></pre>

<p>Myth: Read the file one line at a time. Reality: This does <i>not</i> work reliably. This example has one row:</p>

<pre><code> &quot;foo
 bar&quot;,baz</code></pre>

<p>For shell scripts, use <code>csvtool</code> (<a href="http://merjis.com/developers/csv">http://merjis.com/developers/csv</a> also packaged in major Linux distributions).</p>

<p>For other languages, use a CSV processing library (eg. <code>Text::CSV</code> for Perl or Python&#39;s built-in csv library).</p>

<p>Most spreadsheets and databases can import CSV directly.</p>

<h1 id="exit-status">EXIT STATUS</h1>

<p>This program returns 0 if successful, or non-zero if there was an error.</p>

<h1 id="see-also">SEE ALSO</h1>

<p><a href="http://man.he.net/man1/df">df(1)</a>, <a href="guestfs.3.html">guestfs(3)</a>, <a href="guestfish.1.html">guestfish(1)</a>, <a href="virt-filesystems.1.html">virt-filesystems(1)</a>, <a href="http://libguestfs.org/">http://libguestfs.org/</a>.</p>

<h1 id="author">AUTHOR</h1>

<p>Richard W.M. Jones <a href="http://people.redhat.com/~rjones/">http://people.redhat.com/~rjones/</a></p>

<h1 id="copyright">COPYRIGHT</h1>

<p>Copyright (C) 2009-2015 Red Hat Inc.</p>

<h1 id="license">LICENSE</h1>

<p>This program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.</p>

<p>This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</p>

<p>You should have received a copy of the GNU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.</p>

<h1 id="bugs">BUGS</h1>

<p>To get a list of bugs against libguestfs, use this link: <a href="https://bugzilla.redhat.com/buglist.cgi?component=libguestfs&amp;product=Virtualization+Tools">https://bugzilla.redhat.com/buglist.cgi?component=libguestfs&amp;product=Virtualization+Tools</a></p>

<p>To report a new bug against libguestfs, use this link: <a href="https://bugzilla.redhat.com/enter_bug.cgi?component=libguestfs&amp;product=Virtualization+Tools">https://bugzilla.redhat.com/enter_bug.cgi?component=libguestfs&amp;product=Virtualization+Tools</a></p>

<p>When reporting a bug, please supply:</p>

<ul>

<li><p>The version of libguestfs.</p>

</li>
<li><p>Where you got libguestfs (eg. which Linux distro, compiled from source, etc)</p>

</li>
<li><p>Describe the bug accurately and give a way to reproduce it.</p>

</li>
<li><p>Run <a href="libguestfs-test-tool.1.html">libguestfs-test-tool(1)</a> and paste the <b>complete, unedited</b> output into the bug report.</p>

</li>
</ul>

</body>
</html>

